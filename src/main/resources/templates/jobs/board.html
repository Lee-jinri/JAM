<!DOCTYPE html>
<html 
	xmlns:th="http://www.thymeleaf.org" 
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	layout:decorate="~{template/client/layout}">
<head>
<meta charset="UTF-8">
<title>Jobs</title>
<script th:src="@{/js/area.js}"></script>
<script th:src="@{/js/favorite.js}"></script>
<link rel="stylesheet" th:href="@{/css/job-common.css}">
	<style>
		.filterDiv{
			margin: 5rem 0 3rem;
		}
		.selected-wrapper {
			max-width: 600px;
			width: 100%;
			margin: 10px auto;
			text-align: left;
			margin-bottom: 8px;
			min-height: 23px;
			border: 1px solid #d2d2d2;
		    border-radius: 8px;
		    padding: 20px;
		    display: flex;
		    flex-direction: column;
		}
		
		.selected-location, .selected-position {
			font-weight: bold;
			font-size: 14px;
			color: #333;
			display: flex;
			flex-direction: row;
			gap: 10px;
			margin-bottom: 8px;
			width: fit-content;
		}
		.selected-position{
			flex-wrap: wrap;
		}
		.selected-position-span, .selected-area-span{
		    height: 2rem;
		    margin-top: 8px;
		    padding: 9px 12px;
		    border-color: #e8e8e8;
		    background-color: #f8f8f8;
		    border: 1px solid #e8e8e8;
		    align-items: center;
		    display: inline-flex;
		    border-radius: 4px;
		}
		.selected-position-span{
			justify-content: center;
		}
		.switch-container {
			display: flex;
			align-items: center;
			gap: 10px;
			margin: 20px 0;
			font-weight: bold;
			font-size: 16px;
		}
		
		.switch {
			position: relative;
			display: inline-block;
			width: 50px;
			height: 26px;
		}
		
		.switch input {
			opacity: 0;
			width: 0;
			height: 0;
		}
		
		.slider {
			position: absolute;
			cursor: pointer;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background-color: #ddd;
			transition: 0.4s;
			border-radius: 34px;
		}
		
		.slider:before {
			position: absolute;
			content: "";
			height: 20px;
			width: 20px;
			left: 3px;
			bottom: 3px;
			background-color: white;
			transition: 0.4s;
			border-radius: 50%;
		}
		
		/* ê¸°ë³¸ ìƒ‰ìƒ (unchecked ìƒíƒœì¼ ë•Œ) */
		.slider {
			background-color: #003366;
		}
		
		input:checked+.slider {
			background-color: #ffdd77;
		}
		
		input:checked+.slider:before {
			transform: translateX(24px);
		}
		
		.filterBtnContainer {
			gap: 10px; 
			align-items: center; 
			max-width: 600px;
			margin: 10px auto;
		}
		
		.setting-filter {
			display: none;
			overflow: hidden;
			border: 1px solid #ddd;
			border-radius: 6px;
			background-color: #fff;
			max-width: 800px;
			margin: 0 auto;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
			padding: 10px;
		}
		
		.setting-base-row {
			display: flex;
			justify-content: space-between;
			gap: 8px;
		}
		
		.setting-base__col--title {
			flex: 1;
			height: 40px;
			line-height: 40px;
			font-weight: 600;
			font-size: 1.2rem;
			text-align: center;
			border-bottom: 1px solid #e5e8ec;
			color: #4c515b;
			background-color: #f7f8fa;
			border-right: 1px solid #e5e8ec;
		}
		
		.setting-base__col {
			flex: 1; 
			border: 1px solid #e5e8ec;
			border-radius: 4px;
			background-color: #f9f9f9;
			overflow: hidden;
		}
		
		.setting-base__col--list {
			max-height: 200px; 
			overflow-y: auto;
			background-color: #fff;
			padding: 8px;
			border: 1px solid #e5e8ec;
			border-radius: 4px;
		}
		
		.setting-base__col--list ul {
			list-style: none;
			padding: 0;
			margin: 0;
		}
		
		.setting-base__col--list li {
			padding: 8px 12px;
			font-size: 14px;
			cursor: pointer;
			transition: background-color 0.2s;
			border-bottom: 1px solid #f0f0f0;
		}
		
		.setting-base__col--list li:last-child {
			border-bottom: none;
		}
		
		.setting-base__col--list li:hover {
			background-color: #f0f5ff;
		}
		
		.setting-base__col--list .placeholder {
			color: #aaa;
			font-style: italic;
			text-align: center;
		}
		
		.button-group {
			display: flex;
			gap: 10px; 
		}
		.icon {
		    width: fit-content;
		}
		.filter-btn {
			position: relative;
			padding: 10px 16px;
			font-size: 14px;
			color: #333;
			background-color: #f9f9f9;
			border: 1px solid #ddd;
			border-radius: 6px;
			cursor: pointer;
			display: flex;
			align-items: center;
			font-weight: 500;
			transition: background-color 0.3s;
			justify-content: center;
			width: 90px;
		}
		
		.filter-btn:hover {
			background-color: #f0f0f0;
		}
		
		.filter-btn .icon {
			display: flex;
			align-items: center;
			justify-content: center;
		}
		
		.filter-btn i {
			font-size: 12px;
			color: #555;
		}
		
		#positionContainer {
			background: #f9f9f9;
			padding: 16px;
			border: 1px solid #ddd;
			border-radius: 6px;
			max-width: 600px;
			margin-top: 8px;
		}
		
		.position-grid {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); 
			gap: 8px; 
		}
		
		.position-grid label {
			display: flex;
			align-items: center;
			gap: 6px;
			padding: 8px 12px;
			background: #fff;
			border: 1px solid #ddd;
			border-radius: 6px;
			font-size: 14px;
			cursor: pointer;
			transition: background-color 0.2s, box-shadow 0.2s;
		}
		
		.position-grid label:hover {
			background-color: #f0f0f0;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}
		
		.position-grid input[type="checkbox"] {
			width: 16px;
			height: 16px;
			accent-color: #007bff;
		}
		
		.remove-btn, .area-remove-btn {
			background: none;
			border: none;
			color: #ff6b6b;
			font-weight: bold;
			font-size: 14px;
			cursor: pointer;
			padding-right: 0;
		}
		
		.boardDiv{
			height: 110px;
		}
		.job-board-header span{
			font-weight: bold;
		}
		.title{
			font-weight: normal;
		}
		.payDiv{
			display: flex;
			justify-content: flex-end;
			gap: 6px;
			align-items: center;
		}
		.pay_category {
		background-color: #fff;
		    padding: 2px 8px;
		    border-radius: 28px;
		    font-size: .75rem;
		    line-height: 1rem;
		    align-items: center;
		    display: inline-flex;
		    font-weight: 400;
		}  
		.daily {
			border: 1px solid #ff501b;
		    border-color: #ff501b;
		    color: #ff501b;
		}  
		.weekly {
			border: 1px solid #00b0a6;
		    border-color: #00b0a6;
		    color: #00b0a6;
		}  
		.monthly {
			border: 1px solid #00a1ef;
		    border-color: #00a1ef;
		    color: #00a1ef;
		}
		#pagination{
			padding-top: 40px;
		}
		.pagination > li > .selected_btn{
			color: #0F2D4A;
		    border-color: #0F2D4A;
		    font-weight: 700;
		    background-color: #fff;
		    border: none;
		    font-size: 1rem;
		    font-weight: normal;
		}
		.pagination > li > .default_btn{
			border: none;
			font-size: 1rem;
			font-weight: normal;
		}
		.created_at{
			color: #00a1ef;
		}
		.searchDiv{
			display: flex;
			justify-content: end;
		}
		.searchBtn{
		    border: 1px solid #e8e8e8;
		    padding: 7px 10px 8px;
		    border-radius: 6px;
		    width: 95.5px;
		    text-align: center;
		    height: 36px;
		}
		.postLink{
			cursor: pointer;
		}
		.postLink:hover{
		    background-color: #f5f5f5;
		}
		
		#jobWriteBtn {
			background-color: #0F2D4A;  
			color: #fff;                
			font-weight: 600;       
			padding: 10px 18px;
			border-radius: 7px;
			cursor: pointer;
			transition: background-color 0.25s ease, transform 0.15s ease;
		}
		
		#jobWriteBtn:hover {
			background-color: #163B63; 
			transform: translateY(-2px); 
		}
		
		#jobWriteBtn:active {
			background-color: #0A1E34;
			transform: translateY(0);
		}
		
		#areaConainer{
			display: block;margin: 30px auto;
		}
		
		/* ====== 1024px ì´í•˜ ====== */
		@media (max-width: 1024px) {
			.position-grid { grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); }
			.setting-base__col--list { max-height: 180px; }
		}
		
		/* ====== 768px ì´í•˜: ëª¨ë°”ì¼ (ì¹´ë“œí˜•)====== */
		@media (max-width: 768px) {
			
			 #jobListHeader { display: none !important; }
			
			 .boardDiv {
				display: grid !important;
				grid-template-columns: 0.2fr 1fr 0.5fr;
				grid-template-areas:
					"favorite title date"
					"favorite area area"
					"favorite position pay";
				gap: 6px 10px;
				align-items: center;
				text-align: left;
				padding: 12px 12px !important;
				height: auto !important;
			 }
			
			.boardDiv .title       { grid-area: title; font-size: 0.95rem; font-weight: 600; }
			.boardDiv .created_at  { grid-area: date; justify-self: end; color: #6b7280; font-size: 0.8rem; }
			.boardDiv .area        { grid-area: area; font-size: 0.9rem; color: #374151; }
			.boardDiv .position    { grid-area: position; font-size: 0.9rem; }
			.boardDiv .payDiv      { grid-area: pay; justify-self: end; display: inline-flex; gap: 6px; align-items:center;}
			.boardDiv .favoriteSpan { grid-area: favorite; }
			
			.pay_category {
				font-size: 0.7rem; padding: 2px 8px; 
			}
			.searchBtn { 
				width: auto; padding: 7px 12px 8px; 
			}
			
			.setting-base-row {
			  flex-direction: row;
			}
			.setting-base__col--title {
			  border-right: 1px solid #e5e8ec;
			  border-bottom: 1px solid #e5e8ec;
			  text-align: left;
			  padding-left: 10px;
			  font-size: 11px;
			  display: block;
		        height: 25px;
		        line-height: 25px;
			}
			.setting-base__col--list li{
			  font-size: 11px;
				padding: 6px;
			}
			.remove-btn, .area-remove-btn{
				font-size: 11px;
			}
			
			.position-grid { grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); }
			.position-grid label { padding: 8px 10px; }
			
			.selected-position { 
				gap: 8px; flex-wrap: wrap; 
			}
			.selected-position-span, .selected-area-span {
			    margin: 0px;
		        padding: 3px 4px;
		        height: auto;
		        font-size: 11px;
			}
			
			#jobWriteBtn{font-size: 11px; padding: 7px 6px;}
			.pagination > li > .selected_btn {font-size: 10px;}
			.selected-location-span { font-size: 11px; padding: 0 3px;}
		}
		
		/* ====== 480px ì´í•˜ ====== */
		@media (max-width: 480px) {
			.filterDiv{
				margin: 0;
			}
			.filter-btn {         
				padding: 3px 3px;
		        font-size: 11px;
		        width: 50px;
		        gap: 3px;
			}
			.filter-btn .icon {
			    width: min-content;
			    font-size: 10px;
			}
			.filter-btn i {
			    font-size: 10px;
			}
			.searchBtn {
			    width: auto;
			    padding: 2px 8px;
			    font-size: 11px;
			    height: auto;
			    align-items: center;
			}
			span {
				font-size: 12px;
			}
			.switch-container{
				gap: 5px;
			}
			.switch {
			    width: 30px;
			    height: 17px;
			}
			.slider:before {
			    height: 12px;
			    width: 12px;
			    bottom: 2px;
			}
			input:checked+.slider:before {
			    transform: translateX(12px);
			}
			.selected-wrapper { padding: 12px; }
			.position-grid { grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); gap: 12px;}
			.position-grid label { padding: 4px 2px; font-size: 10px;}
			.position-grid input[type="checkbox"] { width: 10px; height: 10px;}
			#positionContainer{ padding: 6px;}
			.boardDiv .title { font-size: 12px; }
			.boardDiv .area, .boardDiv .position { font-size: 11px; }
			.boardDiv .created_at { font-size: 11px; }
			.payDiv{ align-items: center; }
			.pay_category{
				font-size: 11px;
			    padding: 2px 4px;
			    line-height: normal;
			    align-items: center;
			}
		}
		
	</style>
	<script th:inline="javascript">
		let memberListCache = null;
		let companyListCache = null;
	
		let boardState = {
				  pageNum: 1,
				  search: "all",
				  keyword: "",
				  category: "0", 
				  city: "",
				  gu: "",
				  dong: "",
				  positions: []
				};
	
	
		$(function(){
			getBoard();
			
			$(document).on("click", ".postLink", function (e) {
				e.preventDefault();
				var location = $(this).attr("data-location");
				if (location) {
					window.location.href = location;
				}
			});
			
			$('#typeSwitch').on('change', function() {
				removeArea();
				removeAllPosition();
				
				boardState = {
						  pageNum: 1,
						  search: "all",
						  keyword: "",
						  city: "",
						  gu: "",
						  dong: "",
						  positions: []
						};
				
			    let category = $(this).is(':checked') ? "1" : "0";
			   
			    boardState.category = category;
			    
			    getBoard();
			});
	
			$("#search-btn").click(function(){
			    boardState.category = $("#typeSwitch").is(":checked") ? "1" : "0";
			    boardState.positions= getSelectedPositions(); 
	
			    boardState.pageNum = 1;
	
				boardState.city = $("#city").val();
				boardState.gu = $("#gu").val();
				boardState.dong = $("#dong").val();
				
			    getBoard();
			});
			
			$("#jobWriteBtn").click(function(){
			 	if(window.MY_ID == null) {
			 		if (confirm("ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ë¡œê·¸ì¸ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
						location.href = "/member/login";
					} else {
						location.href = "/jobs/board";
					}
			 		return;
			 	}
				location.href = "/jobs/post/write";
			})
			
			$("#positionBtn").click(function() {
				const $icon = $(this).find("i");
				const $pos = $("#positionContainer");
				const $area = $("#areaContainer");
	
				if ($pos.is(":visible")) {
					$pos.slideUp(300);
					$icon.removeClass("fa-caret-up").addClass("fa-caret-down");
				} else {
					$area.slideUp(300); 
					$pos.slideDown(300);
					$("#areaBtn i").removeClass("fa-caret-up").addClass("fa-caret-down");
					$icon.removeClass("fa-caret-down").addClass("fa-caret-up");
				}
			});
	
			$("#areaBtn").click(function() {
				const $icon = $(this).find("i");
				const $pos = $("#positionContainer");
				const $area = $("#areaContainer");
	
				if ($area.is(":visible")) {
					$area.slideUp(300);
					$icon.removeClass("fa-caret-up").addClass("fa-caret-down");
				} else {
					$pos.slideUp(300);
					$area.slideDown(300);
					$("#positionBtn i").removeClass("fa-caret-up").addClass("fa-caret-down");
					$icon.removeClass("fa-caret-down").addClass("fa-caret-up");
				}
			});
			
			$(document).on("change", ".position-checkbox", function() {
			    updateSelectedPosition();
			});
		})
	
		function getBoard() {
	
			const params = new URLSearchParams(window.location.search);
			const keywordParam = params.get("keyword");
			
			if (keywordParam) {
			    boardState.keyword = keywordParam;
			    $("#keyword").val(keywordParam);
			} else {
			    boardState.keyword = '';
			}

			let queryString = new URLSearchParams(boardState).toString();
			let url = "/api/jobs/board?" + queryString;
	
			fetch(url)
			.then(res => {
				if (!res.ok) {
			    	return res.json().then(err => {
			      		throw new Error(err.detail || "ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
			      	})
			    }
				return res.json()})
			.then(data => {
				if (boardState.category === "0") {
					companyRecruit(data);
					setCompanyStyle();
				} else {
					memberRecruit(data);
					setMemberStyle();
				}
				loadPagination(data.pageMaker);
			}) 
			.catch(err => {
			 	alert(err.message);
			});
		}
	
		const positionMap = {
			    vocal: 'ë³´ì»¬',
			    piano: 'í”¼ì•„ë…¸',
			    guitar: 'ê¸°íƒ€',
			    bass: 'ë² ì´ìŠ¤',
			    drum: 'ë“œëŸ¼',
			    midi: 'ì‘ê³¡Â·ë¯¸ë””',
			    lyrics: 'ì‘ì‚¬',
			    chorus: 'ì½”ëŸ¬ìŠ¤',
			    brass: 'ê´€ì•…ê¸°',
			    string: 'í˜„ì•…ê¸°'
			};
	
		function companyRecruit(data){
			let $template = $("#boardTemplate");
			let $boardList = $("#boardList");
			let $jobHeader = $("#jobListHeader");
			
			$jobHeader.empty();
			$jobHeader.nextAll().remove();
			
			$jobHeader.append(
				    '<div class="job-board-header pd-2rem company-list-row text-alignC items-center">' +
				        '<span></span>' +
				        '<span>ê³µê³ ì œëª©/ê¸°ì—…ëª…</span>' +
				        '<span>ê·¼ë¬´ì§€</span>' +
				        '<span>í¬ì§€ì…˜</span>' +
				        '<span>ê¸‰ì—¬</span>' +
				        '<span>ë“±ë¡ì¼</span>' +
				    '</div>'
			);
			data.jobList.forEach(board => {
				let $clone = $template.clone().removeAttr("id").show();
				
				let $boardDiv = $clone.find(".boardDiv");
				$boardDiv.removeClass("member-list-row").addClass("company-list-row");
				
				let areaText = board.city;
				if(board.gu != null) areaText += "\u00A0" + board.gu;
				if(board.dong != null) areaText += "\u00A0" + board.dong;
				
				$clone.find(".area").text(areaText);
				$clone.find(".position").text(positionMap[board.position]);
				$clone.find(".title").text(board.title);
				$clone.find(".postLink").attr("data-location", "/jobs/post/" + board.post_id);

				let $favoriteSpan = $clone.find(".favoriteSpan");
				
				if(!window.MY_AUTH || !window.MY_AUTH.includes('ROLE_COMPANY')){
					$favoriteSpan.attr("data-post-id", board.post_id);
					$favoriteSpan.attr("data-board-type", "JOB");
					
					const $favoriteStar = $('<i>')
					    .addClass('favorite fa-star')
					    .css({'color': '#FFD43B', 'cursor': 'pointer'});
					
					board.favorite ? $favoriteStar.addClass("fa-solid")
								   : $favoriteStar.addClass("fa-regular");
					
					$favoriteSpan.append($favoriteStar);
				}
				
				const payTexts = ["ê±´ë³„ ", "ì£¼ê¸‰ ", "ì›”ê¸‰ ", "í˜‘ì˜ í›„ ê²°ì •"];
				let payText = payTexts[board.pay_category] || "í˜‘ì˜ í›„ ê²°ì •";
				
				let $payDiv =$clone.find(".payDiv");
				$payDiv.find(".pay").text(board.pay_category < 3 ? formatNumberKo(board.pay) + "ì›" : "í˜‘ì˜ í›„ ê²°ì •");
				
				let $payCategory = $payDiv.find(".pay_category");
				if(board.pay_category < 3){
					$payCategory.text(payText)
				} else{
					$payCategory.css("display","none");
					$payDiv.css("justifyContent","center");	
				}
				
				if(board.pay_category == 0) $payCategory.addClass("daily");
				else if(board.pay_category == 1) $payCategory.addClass("weekly");
				else if(board.pay_category == 2) $payCategory.addClass("monthly");
	
				let date = timeAgo(board.created_at);
				$clone.find(".created_at").text(date);
				
				$boardList.append($clone);
			});
			
			loadPagination(data.pageMaker);
		}
	
		function memberRecruit(data){
			let $template = $("#boardTemplate");
			let $boardList = $("#boardList");
			let $jobHeader = $("#jobListHeader");
			
			$jobHeader.empty();
			$jobHeader.nextAll().remove();
			
			$jobHeader.append(
				    '<div class="job-board-header pd-2rem member-list-row text-alignC items-center">' +
				        '<span></span>' +
				        '<span>ì œëª©</span>' +
				        '<span>ì—°ìŠµ/í™œë™ ì¥ì†Œ</span>' +
				        '<span>í¬ì§€ì…˜</span>' +
				        '<span></span>' +
				        '<span>ë“±ë¡ì¼</span>' +
				    '</div>'
			);
	
			data.jobList.forEach(board => {
				let $clone = $template.clone().removeAttr("id").show();
				
				let $boardDiv = $clone.find(".boardDiv");
				$boardDiv.removeClass("company-list-row").addClass("member-list-row");

				let $favoriteSpan = $clone.find(".favoriteSpan");
				
				$favoriteSpan.attr("data-post-id", board.post_id);
				$favoriteSpan.attr("data-board-type", "JOB");
				
				const $favoriteStar = $('<i>')
				    .addClass('favorite fa-star')
				    .css({'color': '#FFD43B', 'cursor': 'pointer'});
				
				board.favorite ? $favoriteStar.addClass("fa-solid")
							   : $favoriteStar.addClass("fa-regular");
				
				$favoriteSpan.append($favoriteStar);
				
				$clone.find(".pay").remove();  
				
				let areaText = board.city;
				if(board.gu != null) areaText += "\u00A0" + board.gu;
				if(board.dong != null) areaText += "\u00A0" + board.dong;
				
				$clone.find(".area").text(areaText);
				$clone.find(".position").text(positionMap[board.position]);
				$clone.find(".title").text(board.title);
				$clone.find(".postLink").attr("data-location", "/jobs/post/" + board.post_id);
				
				let date = timeAgo(board.created_at);
				$clone.find(".created_at").text(date);
				
				$boardList.append($clone);
			});
			
			loadPagination(data.pageMaker);
		}
	
	
		function updateUrl(newParams){
			let currentParams = new URLSearchParams(window.location.search);
	
			if (newParams.hasOwnProperty("search") || newParams.hasOwnProperty("keyword") || newParams.hasOwnProperty("category")) {
		        newParams.pageNum = 1; 
		    }
			
			[...currentParams.keys()].forEach(key => {
		        if (key.startsWith('positions')) {
		            currentParams.delete(key);
		        }
		    });
	
			// ë³€ê²½ëœ ê°’ ì—…ë°ì´íŠ¸
		    for (const key in newParams) {
		        if (newParams[key] === undefined || newParams[key] === null || newParams[key] === '') {
		            currentParams.delete(key); 
		        } else if (key === "positions") {
		            // í¬ì§€ì…˜ ê°ê° ì¶”ê°€
		            newParams[key].split(',').forEach(pos => {
		                currentParams.append("positions", pos);
		            });
		        } else {
		            currentParams.set(key, newParams[key]);
		        }
		    }
		    
		    let newUrl = "/jobs/board?" + currentParams.toString();
		    
		    location.href = newUrl;
		}
	
		function getSelectedPositions() {
		    const positions = [];
		    $(".position-checkbox:checked").each(function() {
		        positions.push($(this).val());
		    });
		    return positions.join(",");  // ì‰¼í‘œë¡œ êµ¬ë¶„í•´ì„œ ë¬¸ìì—´ë¡œ ë°˜í™˜
		}
	
		function loadPagination(pageMaker) {
		    const $pagination = $("#pagination");
		    $pagination.empty(); 
		    
		    for (let num = pageMaker.startPage; num <= pageMaker.endPage; num++) {
		        $pagination.append(
		            '<li class="paginate_button">' +
		                '<a href="#" data-page="' + num + '" class="font-weight-bold ' + (pageMaker.cvo.pageNum === num ? 'selected_btn' : 'default_btn') + '">' + num + '</a>' +
		            '</li>'
		        );
		    }
	
		    $("#pagination a").click(function (e) {
		        e.preventDefault();
		        let pageNum = $(this).data("page");
		        
		        boardState.pageNum = pageNum;
		        getBoard();
		    });
		}
	
		//ì„ íƒí•œ í¬ì§€ì…˜ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
		function updateSelectedPosition() {
		    const selectedPosition = [];
	
		    $(".position-grid input[type='checkbox']:checked").each(function() {
		    	selectedPosition.push($(this).parent().text().trim());
		    });
	
		    displaySelectedPosition(selectedPosition);
		}
	
		// ì„ íƒí•œ í¬ì§€ì…˜ í‘œì‹œ í•¨ìˆ˜
		function displaySelectedPosition(Position) {
		    const $selectedPosition = $("#selectedPosition");
		    $selectedPosition.empty();  
	
		    $selectedPosition.show();  
	
		    Position.forEach(pos => {
		        const span = $("<span>").addClass("selected-position-span").text(pos);
		        
		        const removeBtn = $("<button>")
		        .addClass("remove-btn")
		        .html('<i class="fa-solid fa-x"></i>')
		        .on("click", function() {
		            removePosition(pos);
		        });
	
		        span.append(removeBtn);
		        $selectedPosition.append(span);
		    });
		}
	
		// í¬ì§€ì…˜ ì œê±° í•¨ìˆ˜ (xë²„íŠ¼ í´ë¦­ ì‹œ)
		function removePosition(position) {
		    $(".position-grid input[type='checkbox']").each(function() {
		        if ($(this).parent().text().trim() === position) {
		            $(this).prop("checked", false); 
		        }
		    });
	
		    updateSelectedPosition(); 
		}
	
		// ëª¨ë“  í¬ì§€ì…˜ ì„ íƒ ì·¨ì†Œ
		function removeAllPosition(){
			$(".position-grid input[type='checkbox']").each(function() {
		        $(this).prop("checked", false);  
		    });
	
		    updateSelectedPosition();
		}
	
		function setMemberStyle() {
		    $(".content").addClass("member-mode").removeClass("company-mode");
		    
		    let canWrite = false;
		    canWrite = window.MY_AUTH && !window.MY_AUTH.includes("ROLE_COMPANY");
		    
			$(".write_btn").css("display", canWrite ? "flex" : "none");
		}
	
		function setCompanyStyle() {
		    $(".content").addClass("company-mode").removeClass("member-mode");
		    
		    let canWrite = false;
		    canWrite = window.MY_AUTH?.includes("ROLE_COMPANY");
		    
			$(".write_btn").css("display", canWrite ? "flex" : "none");
		}
	
	
	
		function formatNumberKo(pay) {
			const num = Number(String(pay).replace(/[^\d]/g, ''));
			return num ? num.toLocaleString('ko-KR') : '';
		}
	</script>
</head>
<body>
	<div layout:fragment="body">
		<div data-recruit-type="0" class="contents">
			<div class="content company-mode container" >
				<div class="my-top-15 my-bottom-15">
					<input type="hidden" id="city">
					<input type="hidden" id="gu">
					<input type="hidden" id="dong">
					
					<div class="filterDiv">
						<div class="filterBtnContainer flex">
							<button id="areaBtn" class="filter-btn neo-btn">
						        ì§€ì—­
						        <span class="icon"><i class="fa-solid fa-caret-down"></i></span>
						    </button>
							<button id="positionBtn" class="filter-btn neo-btn">
					        	í¬ì§€ì…˜
					        	<span class="icon"><i class="fa-solid fa-caret-down"></i></span>
						    </button>
						</div>
						<div>
							<div id="positionContainer" class="setting-filter" style="display: none;">
							    <div class="position-grid">
							        <label><input type="checkbox" class="position-checkbox" value="vocal"> ë³´ì»¬</label>
							        <label><input type="checkbox" class="position-checkbox" value="piano"> í”¼ì•„ë…¸</label>
							        <label><input type="checkbox" class="position-checkbox" value="guitar"> ê¸°íƒ€</label>
							        <label><input type="checkbox" class="position-checkbox" value="bass"> ë² ì´ìŠ¤</label>
							        <label><input type="checkbox" class="position-checkbox" value="drum"> ë“œëŸ¼</label>
							        <label><input type="checkbox" class="position-checkbox" value="midi"> ì‘ê³¡Â·ë¯¸ë””</label>
							        <label><input type="checkbox" class="position-checkbox" value="lyrics"> ì‘ì‚¬</label>
							        <label><input type="checkbox" class="position-checkbox" value="chorus"> ì½”ëŸ¬ìŠ¤</label>
							        <label><input type="checkbox" class="position-checkbox" value="brass"> ê´€ì•…ê¸°</label>
							        <label><input type="checkbox" class="position-checkbox" value="string"> í˜„ì•…ê¸°</label>
							    </div>
							</div>
							<div id="areaContainer" class="setting-filter">
								<div class="setting-base-row">
									<div class="setting-base__col setting-base__col--title">ì‹œÂ·ë„</div>
									<div class="setting-base__col setting-base__col--title">êµ¬Â·êµ°</div>
									<div class="setting-base__col setting-base__col--title">ë™Â·ìÂ·ë©´</div>
								</div>
								<div class="setting-base-row">
									<div class="setting-base__col setting-base__col--list">
										<ul id="cityList">
											<li class="city cursor-pointer" data-city="ì„œìš¸">ì„œìš¸</li>
							                <li class="city cursor-pointer" data-city="ë¶€ì‚°">ë¶€ì‚°</li>
							                <li class="city cursor-pointer" data-city="ëŒ€êµ¬">ëŒ€êµ¬</li>
							                <li class="city cursor-pointer" data-city="ì¸ì²œ">ì¸ì²œ</li>
							                <li class="city cursor-pointer" data-city="ê´‘ì£¼">ê´‘ì£¼</li>
							                <li class="city cursor-pointer" data-city="ëŒ€ì „">ëŒ€ì „</li>
							                <li class="city cursor-pointer" data-city="ìš¸ì‚°">ìš¸ì‚°</li>
							                <li class="city cursor-pointer" data-city="ì„¸ì¢…">ì„¸ì¢…</li>
							                <li class="city cursor-pointer" data-city="ê²½ê¸°">ê²½ê¸°</li>
							                <li class="city cursor-pointer" data-city="ê°•ì›">ê°•ì›</li>
							                <li class="city cursor-pointer" data-city="ì¶©ë¶">ì¶©ë¶</li>
							                <li class="city cursor-pointer" data-city="ì¶©ë‚¨">ì¶©ë‚¨</li>
							                <li class="city cursor-pointer" data-city="ì „ë¶">ì „ë¶</li>
							                <li class="city cursor-pointer" data-city="ì „ë‚¨">ì „ë‚¨</li>
							                <li class="city cursor-pointer" data-city="ê²½ë¶">ê²½ë¶</li>
							                <li class="city cursor-pointer" data-city="ê²½ë‚¨">ê²½ë‚¨</li>
							                <li class="city cursor-pointer" data-city="ì œì£¼">ì œì£¼</li>
										</ul>
									</div>
									<div class="setting-base__col setting-base__col--list">
							            <ul id="guList">
							                <li class="placeholder">êµ¬ ì„ íƒ</li>
							            </ul>
							        </div>
							
							        <!-- ë™ ëª©ë¡ -->
							        <div class="setting-base__col setting-base__col--list">
							            <ul id="dongList">
							                <li class="placeholder">ë™ ì„ íƒ</li>
							            </ul>
							        </div>
								</div>							
							</div>	
						</div>	
						<div class="selected-wrapper">
						    <div id="selectedAreaWrapper" class="selected-location inline">
						        <span id="selectedArea" class="selected-location-span"></span>
						    </div>
						    <div id="selectedPosition" class="selected-position inline">
						    </div>
						    <div class="searchDiv">
						    	<button id="search-btn" class="searchBtn">ê²€ìƒ‰</button>
						    </div>
						</div>
					</div>
						
					
					
					<div class="justify-between py-4 flex">
						<div class="switch-container">
						    <span class="switch-label">ê¸°ì—… êµ¬ì¸ğŸ¢</span>
						    <label class="switch">
						        <input type="checkbox" id="typeSwitch">
						        <span class="slider"></span>
						    </label>
						    <span class="switch-label">ë©¤ë²„ ëª¨ì§‘ğŸ•ï¸</span>
						</div>
						
					    <div sec:authorize="isAuthenticated()" class="write_btn items-center none">
					    	<button type="button" id="jobWriteBtn" class="write_btn_font border-none ">
								<i class="fa-solid fa-pen-to-square write-icon">
									ì‘ì„±í•˜ê¸°
								</i>
							</button>
						</div>
					</div>
					
					<div>
						<ul style="display:none">
							<li id="boardTemplate" class="border-bottom">
								<div class="boardDiv postLink pd-2rem job-list-row text-alignC items-center">
									<span class="favoriteSpan">
									</span>
									<span class="font-size-5 title"  style="cursor: pointer;"></span>
							        
									<span class="area"></span>
									<span class="position"></span>
									
							        <div class="payDiv">
							        	<span class="pay"></span>
							        	<span class="pay_category"></span>
							        </div>
							        
							        <span class="created_at"></span>
								</div>
							</li>
						</ul>
						
						
						<ul id="boardList">
							<li id="jobListHeader" class="border-top border-bottom">
							</li>
						</ul>
					</div>
					
					<div>
						<div class="text-center">
						    <ul id="pagination" class="pagination pagination_border"></ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>